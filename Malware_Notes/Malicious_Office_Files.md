[Cheat_Sheet](https://zeltser.com/analyzing-malicious-documents/)
Office File Formats and Types:

- OLE ( Object Linking Embedding ) - doc, ppt, xls

- OOXML ( Office Open eXtensible Markup Language) [Read](http://officeopenxml.com/anatomyofOOXML.php) - docx, pptx, xlsx : **This files cannot be used to store VBA markers. But this files can store objects, like images, charts, graphs and so on.** And they also contain the information about the relation between the objects. we said that this files can not contain VBA codes, but this can bypass  this restriction by using the macro enable formats (docm, xlsm, pptm) or using **Template Injection**. An OOXML document can have embedded external relationships, These relationships are use to embed documents or web page inside a document, but malware authors often use these to host malicious web content that exploit vulnerabilities in the MS Office suite or even host malicious scripts to infect a host.

- RTF (Rich Text Format) - .rtf : rtf is basically encoding the text in a way that each user be able to open that file even if he doesn't have windows or if he doesn't have office suit. In the past there was a big issue when a mac or linux user wants to open office files (before google docs :D) and "rtf" was a solution for that. **The difference between "rtf" and a normal text file is that, "rtf" can have fonts, images and so on.** RTF files start with '{\rtf'.

---
### How to start analyzing ?

First of all use **"oleid"** to get some information about the binary.

if( File contains VBA or Macro code ):
	- Then use **"olevba"** to get the macro.
	- In case of VBA code : streams with macros are appended with M or m, itâ€™s important to note that streams with M (uppercase) are used to show macro with VBA code inside,  while m (lowercase) are used to show macro with a user denoted form.
	- Or **"oledump.py"** to get dump some specific sections.

if( File contains Relationshiops ):
	- Then use **"oleobj"** to extract the relationships.

if( File is a rtf file that contains simple text ):
	- Then use **"rtfdump.py"** to dump all the strings and sections inside that file.
	- Use flags "-s" to select the what seems strange in sections and "-H" for Hexdecimal in less
	- Look at hex and strings to see what seems suspicious. if not finding anything search for "**0D 0C F1 1E 0A 1B 11 AE ...**" which is a signature for an embedded object. 
	- If you that signature and the bits after this signature are mostly not clear (00 or FF) then it might be a shell code.
	- To get embedded code out you can use another tool called **"rtfobj"** and  get all the objects inside the rtf file. ex : "> rtfobj -s all malicoius.rtf         or just specific sections   > rtfobj -s 3 malicious.rtf "
